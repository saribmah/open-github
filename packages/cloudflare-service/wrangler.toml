name = "github-sandbox-orchestrator"
main = "src/index.ts"
compatibility_date = "2024-11-18"
compatibility_flags = ["nodejs_compat"]

# Development server configuration
[dev]
port = 8787
ip = "127.0.0.1"

# Containers configuration - Required for Sandbox SDK
[[containers]]
class_name = "Sandbox"
image = "./Dockerfile"
instance_type = "lite"
max_instances = 10

# Durable Objects configuration
[[durable_objects.bindings]]
name = "SANDBOX_MANAGER"
class_name = "SandboxManager"

[[durable_objects.bindings]]
name = "Sandbox"
class_name = "Sandbox"

# Migrations for Durable Objects
[[migrations]]
tag = "v1"
new_sqlite_classes = ["SandboxManager", "Sandbox"]

# Environment variables (set via wrangler secret for sensitive values)
[vars]
GITHUB_API_URL = "https://api.github.com"
DEFAULT_BRANCH = "main"
OPENCODE_PORT = "4096"
ENVIRONMENT = "development"

# Production environment configuration
[env.production]
name = "github-sandbox-orchestrator-prod"

[env.production.vars]
ENVIRONMENT = "production"
WORKER_HOSTNAME = "your-domain.com"  # Change this to your custom domain
